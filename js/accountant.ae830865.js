(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["accountant"],{"386d":function(e,t,n){"use strict";var a=n("cb7c"),r=n("83a1"),c=n("5f1b");n("214f")("search",1,(function(e,t,n,o){return[function(n){var a=e(this),r=void 0==n?void 0:n[t];return void 0!==r?r.call(n,a):new RegExp(n)[t](String(a))},function(e){var t=o(n,e,this);if(t.done)return t.value;var s=a(e),i=String(this),l=s.lastIndex;r(l,0)||(s.lastIndex=0);var u=c(s,i);return r(s.lastIndex,l)||(s.lastIndex=l),null===u?-1:u.index}]}))},7789:function(e,t,n){},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},ae75:function(e,t,n){"use strict";var a=n("7789"),r=n.n(a);r.a},fac7:function(e,t,n){"use strict";n.r(t);var a,r,c,o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return!0===e.isLoaded?n("div",[n("Pending")],1):e._e()},s=[],i=(n("96cf"),n("3b8d")),l=n("d225"),u=n("b0b4"),d=n("308d"),b=n("6bb5"),m=n("4e2b"),y=n("9ab4"),f=n("60a3"),p=(n("8e6e"),n("456d"),n("bd86")),g=(n("ac6a"),n("5df3"),n("768b")),h=n("6fc5"),v=n("2ef0"),k=n.n(v);(function(e){e["None"]="None",e["Grocery"]="Grocery",e["Meal"]="Meal",e["Recreation"]="Recreation",e["Shopping"]="Shoppiong",e["Utility"]="Utility",e["Vehicle"]="Vehicle",e["Others"]="Others",e["Special"]="Special"})(a||(a={})),function(e){e["Cash"]="Cash",e["Checking"]="Checking",e["Credit"]="Credit",e["Saving"]="Saving"}(r||(r={})),function(e){e["None"]="None",e["Pending"]="Pending",e["Settled"]="Settled",e["Merged"]="Merged",e["Verified"]="Verified"}(c||(c={}));n("7f7f");var S=n("ade2"),O=n("84d6"),j=function(){function e(){Object(l["a"])(this,e)}return Object(u["a"])(e,[{key:"convertToAccount",value:function(e){return{id:e.id,name:e.name,symbol:e.symbol,tenantId:e.tenantId,type:this.getExpenseType(e.expenseType),userId:e.userId}}},{key:"convertToTransaction",value:function(e){return{accountId:e.accountId,amount:e.amount,date:e.date,expenseCategory:e.expenseCategory,id:e.id,name:e.name,note:e.note,plaidPendingId:e.plaidPendingId,plaidTransactionId:e.plaidTransactionId,state:e.transactionState,tenantId:e.tenantId,verifiedDate:e.verifiedDate}}},{key:"getExpenseType",value:function(e){switch(e){case S["b"].Cash:return r.Cash;case S["b"].Checking:return r.Checking;case S["b"].Credit:return r.Credit;case S["b"].Saving:return r.Saving}throw new O["a"]("Unknown GoldStoneExpenseType")}}]),e}(),w=new j,x=n("30d2"),C=n("4e4a"),A=n("4c4c"),I=n("c4c2"),T=n("e5e0"),_=n("ca39");function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(n,!0).forEach((function(t){Object(p["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D={accounts:{},transactions:{}},M=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(d["a"])(this,Object(b["a"])(t).apply(this,arguments)),e.State=k.a.cloneDeep(D),e}return Object(m["a"])(t,e),Object(u["a"])(t,[{key:"clear",value:function(e){this.context.commit("Clear",e)}},{key:"initAsync",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){var t,n,a,r,c,o,s,i,l,u,d,b,m,y,f,p,h,v,O,j;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=I["a"].Today().addDays(-2),n=I["a"].Today(),a=S["c"].getAccountsAsync(!1,!0),r=S["c"].getTransactionsAsync(t,n),c=S["c"].getUsersAsync(),e.next=7,x["a"].sendAsync((function(){return Promise.all([a,r,c])}));case 7:if(o=e.sent,s=Object(g["a"])(o,3),i=s[0],l=s[1],u=s[2],d=C["a"].handleApiResponse(i),!1!==d.success){e.next=15;break}return e.abrupt("return");case 15:if(d=C["a"].handleApiResponse(l),!1!==d.success){e.next=18;break}return e.abrupt("return");case 18:if(d=C["a"].handleApiResponse(u),!1!==d.success){e.next=21;break}return e.abrupt("return");case 21:if(b=i.data,m=l.data,y=u.data,!(!b||!m||!y||b.length<=0||m.length<=0||y.length<=0)){e.next=26;break}return e.abrupt("return");case 26:f=b.map((function(e){return w.convertToAccount(e)})),p=m.map((function(e){return w.convertToTransaction(e)})),h=y.map((function(e){return T["a"].convertToUser(e)})),v=k.a.keyBy(f,(function(e){return e.id})),O=k.a.keyBy(p,(function(e){return e.id})),j=k.a.keyBy(h,(function(e){return e.id})),_["a"].setUsers(j),this.context.commit("Init",{accounts:v,transactions:O});case 34:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"Clear",value:function(e){var t=k.a.cloneDeep(D);this.State=t}},{key:"Init",value:function(e){var t=e.accounts,n=e.transactions;this.State=L({},this.State,{accounts:k.a.cloneDeep(t),transactions:k.a.cloneDeep(n)})}},{key:"transactions",get:function(){return k.a.values(this.State.transactions)}},{key:"transactionMap",get:function(){return this.State.transactions}},{key:"pendingTransactions",get:function(){return this.transactions.filter((function(e){return e.state===c.Pending}))}},{key:"getAccount",get:function(){var e=this;return function(t){return e.State.accounts[t]}}}]),t}(h["d"]);Object(y["a"])([h["a"]],M.prototype,"clear",null),Object(y["a"])([h["a"]],M.prototype,"initAsync",null),Object(y["a"])([h["c"]],M.prototype,"Clear",null),Object(y["a"])([h["c"]],M.prototype,"Init",null),M=Object(y["a"])([Object(h["b"])({namespaced:!0,name:"AccountantStore",store:A["a"],dynamic:!0})],M);var U=Object(h["e"])(M),N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("md-table",{style:e.scrollStyle,attrs:{"md-card":"","md-fixed-header":"","md-sort":"date","md-sort-order":"desc"},on:{"md-selected":e.onSelect},scopedSlots:e._u([{key:"md-table-alternate-header",fn:function(t){var a=t.count;return n("md-table-toolbar",{},[n("div",{staticClass:"md-toolbar-section-start"},[e._v(e._s(e.getAlternateLabel(a)))]),n("div",{staticClass:"md-toolbar-section-end"},[n("md-button",{staticClass:"md-icon-button"},[n("md-icon",[e._v("delete")])],1)],1)])}},{key:"md-table-row",fn:function(t){var a=t.item;return n("md-table-row",{staticClass:"md-primary",attrs:{"md-selectable":"multiple","md-auto-select":""}},[n("md-table-cell",{attrs:{"md-label":"Users"}},[n("md-avatar",[n("img",{attrs:{src:e.getUserProfileImage(a.accountId),alt:"Avatar"}})])],1),n("md-table-cell",{style:e.isSelected(a.id)?{}:e.pendingStyle,attrs:{"md-label":"Symbol","md-sort-by":"symbol"}},[e._v(e._s(e.getAccountSymbol(a.accountId))+"\n      ")]),n("md-table-cell",{style:e.isSelected(a.id)?{}:e.pendingStyle,attrs:{"md-label":"Date","md-sort-by":"date"}},[e._v(e._s(a.date)+"\n      ")]),n("md-table-cell",{style:e.isSelected(a.id)?{}:e.pendingStyle,attrs:{"md-label":"Name","md-sort-by":"name"}},[e._v(e._s(a.name)+"\n      ")]),n("md-table-cell",{style:e.isSelected(a.id)?{}:e.getAmountStyle(a.amount),attrs:{"md-label":"Amount","md-sort-by":"amount"}},[e._v(e._s(e.getFormattedAmount(a.amount))+"\n      ")]),n("md-table-cell",{style:e.isSelected(a.id)?{}:e.pendingStyle,attrs:{"md-label":"Category","md-sort-by":"category"}},[e._v(e._s(a.expenseCategory)+"\n      ")]),n("md-table-cell",{style:e.isSelected(a.id)?{}:e.pendingStyle,attrs:{"md-label":"Note","md-sort-by":"note"}},[n("div",{staticStyle:{"margin-top":"-30px","margin-bottom":"-35px"}},[n("md-field",[n("md-textarea",{attrs:{"md-autogrow":""},model:{value:e.transactionMap[a.id].note,callback:function(t){e.$set(e.transactionMap[a.id],"note",t)},expression:"transactionMap[item.id].note"}})],1)],1)]),n("md-table-cell",{attrs:{"md-label":"Save"}},[n("md-icon",{style:e.saveStyle},[e._v("\n          save\n        ")])],1)],1)}}]),model:{value:e.searched,callback:function(t){e.searched=t},expression:"searched"}},[n("md-table-toolbar",[n("div",{staticClass:"md-toolbar-section-start"},[n("h1",{staticClass:"md-title",style:e.titleStyle},[e._v("Pending\n        ")])]),n("md-field",{staticClass:"md-toolbar-section-end",attrs:{"md-clearable":""}},[n("md-input",{attrs:{placeholder:"Search by name"},on:{input:e.searchOnTable},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),n("md-table-empty-state",{attrs:{"md-label":"No transactions found","md-description":"No transaction found for this '"+e.search+"' query. Try a different search term."}})],1),n("md-button",{staticClass:"md-primary",on:{click:e.toLegacy}},[e._v("\n    To Legacy\n  ")])],1)},R=[],E=(n("6b54"),n("386d"),n("6762"),n("2fdb"),function e(){Object(l["a"])(this,e)});E.Layout={Colors:{Light:{Test:""},Dark:{Test:""}}},E.Pending={Colors:{Light:{Font:""},Dark:{Font:"#ffcf44"}}};var F=n("a31a"),B=n("4fe9"),V=n("d529"),G=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(d["a"])(this,Object(b["a"])(t).apply(this,arguments)),e.search=null,e.searched=U.pendingTransactions,e.selectedIds=[],e.transactionMap=U.transactionMap,e}return Object(m["a"])(t,e),Object(u["a"])(t,[{key:"getAlternateLabel",value:function(e){var t=e>1?"s":"";return"".concat(e," transaction").concat(t," selected")}},{key:"getAmountStyle",value:function(e){return{color:C["a"].getAmountColor(e,B["a"].theme)}}},{key:"getFormattedAmount",value:function(e){return C["a"].getFormattedAmount(e)}},{key:"getUserProfileImage",value:function(e){var t=U.getAccount(e),n=_["a"].getUser(t.userId);return n?n.profileImageUrl:void 0}},{key:"getAccountSymbol",value:function(e){var t=U.getAccount(e);return t?t.symbol:""}},{key:"isSelected",value:function(e){return this.selectedIds.includes(e)}},{key:"onSelect",value:function(e){this.selectedIds=e.map((function(e){return e.id}))}},{key:"searchOnTable",value:function(){this.searched=this.searchByName(U.pendingTransactions,this.search)}},{key:"searchByName",value:function(e,t){var n=this;return t?e.filter((function(e){return n.toLower(e.name).includes(n.toLower(t))})):e}},{key:"toLower",value:function(e){return e.toString().toLowerCase()}},{key:"toLegacy",value:function(){window.open("https://goldstone.azurewebsites.net/expenses?".concat(_["a"].id),"_blank")}},{key:"pendingStyle",get:function(){return{color:E.Pending.Colors[B["a"].theme].Font}}},{key:"saveStyle",get:function(){return{color:F["a"].Layout.Colors[B["a"].theme].Accent}}},{key:"scrollStyle",get:function(){return!0===V["a"].isMobile()?{overflowX:"scroll"}:{}}},{key:"titleStyle",get:function(){return{color:F["a"].Layout.Colors[B["a"].theme].Accent,fontWeight:"bold"}}}]),t}(f["c"]);G=Object(y["a"])([f["a"]],G);var $=G,J=$,q=(n("ae75"),n("2877")),z=Object(q["a"])(J,N,R,!1,null,"be6b4ff8",null),W=z.exports,X=function(e){function t(){var e;return Object(l["a"])(this,t),e=Object(d["a"])(this,Object(b["a"])(t).apply(this,arguments)),e.accountant=U,e}return Object(m["a"])(t,e),Object(u["a"])(t,[{key:"mounted",value:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(U.transactions.length>0)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,U.initAsync();case 4:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"isLoaded",get:function(){return U.transactions.length>0}}]),t}(f["c"]);X=Object(y["a"])([Object(f["a"])({components:{Pending:W}})],X);var H=X,K=H,Q=Object(q["a"])(K,o,s,!1,null,null,null);t["default"]=Q.exports}}]);
//# sourceMappingURL=accountant.ae830865.js.map